!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>Painel do Administrador</title>
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css"
    />
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
  </head>
  <body>
    <h1>Painel do Administrador</h1>
    {% for micro in dados_por_micro %}
    <h2>{{ micro.micro }} - {{ micro.planilha }} ({{ micro.usuario }})</h2>

    {% if micro.erro %}
    <p style="color: red">Erro ao carregar: {{ micro.erro }}</p>
    {% elif micro.dados %}
    <table class="display">
      <thead>
        <tr>
          {% for col in micro.dados[0].keys() %}
          <th>{{ col }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for linha in micro.dados %}
        <tr>
          {% for valor in linha.values() %}
          <td>{{ valor }}</td>
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <hr />
    {% else %}
    <p>Nenhum dado encontrado.</p>
    {% endif %} {% endfor %}

    <script>
      $(document).ready(function () {
        $("table.display").DataTable({
          order: [],
          pageLength: 5,
          language: {
            url: "//cdn.datatables.net/plug-ins/1.13.6/i18n/pt-BR.json",
          },
        });
      });
    </script>
  </body>
</html>
